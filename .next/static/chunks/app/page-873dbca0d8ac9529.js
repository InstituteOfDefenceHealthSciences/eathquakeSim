(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7145:function(e,t,a){Promise.resolve().then(a.bind(a,7095))},7095:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var s=a(7437),i=a(2265);function n(e){let{config:t,onConfigChange:a,onRunVisual:i,onRunMonteCarlo:n,onExportExcel:r,onReset:l,isRunning:o,progress:d}=e,u=e=>{a({...t,...e})};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium",children:"Scenario"}),(0,s.jsxs)("select",{value:t.scenario,onChange:e=>u({scenario:e.target.value}),className:"w-full p-2 border rounded",disabled:o,children:[(0,s.jsx)("option",{value:"daytime",children:"Daytime Earthquake"}),(0,s.jsx)("option",{value:"nighttime",children:"Nighttime Earthquake"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium",children:"Baseline ED Daily"}),(0,s.jsx)("input",{type:"number",value:t.baselineEDDaily,onChange:e=>u({baselineEDDaily:Number(e.target.value)}),className:"w-full p-2 border rounded",disabled:o})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium",children:"K1"}),(0,s.jsx)("input",{type:"number",step:"0.1",value:t.k1,onChange:e=>u({k1:Number(e.target.value)}),className:"w-full p-2 border rounded",disabled:o})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium",children:"K2"}),(0,s.jsx)("input",{type:"number",step:"0.1",value:t.k2,onChange:e=>u({k2:Number(e.target.value)}),className:"w-full p-2 border rounded",disabled:o})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium",children:"K3"}),(0,s.jsx)("input",{type:"number",step:"0.1",value:t.k3,onChange:e=>u({k3:Number(e.target.value)}),className:"w-full p-2 border rounded",disabled:o})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Policies"}),Object.entries(t.policies).map(e=>{let[a,i]=e;return(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:i.active,onChange:e=>u({policies:{...t.policies,[a]:{...i,active:e.target.checked}}}),disabled:o}),(0,s.jsx)("span",{className:"text-sm",children:a.toUpperCase()}),(0,s.jsxs)("select",{value:i.time,onChange:e=>u({policies:{...t.policies,[a]:{...i,time:Number(e.target.value)}}}),className:"p-1 border rounded text-sm",disabled:o,children:[(0,s.jsx)("option",{value:12,children:"12h"}),(0,s.jsx)("option",{value:24,children:"24h"}),(0,s.jsx)("option",{value:36,children:"36h"}),(0,s.jsx)("option",{value:48,children:"48h"})]})]},a)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium",children:"Snapshot Interval (min)"}),(0,s.jsx)("input",{type:"number",min:"1",max:"10",value:t.snapshotInterval,onChange:e=>u({snapshotInterval:Number(e.target.value)}),className:"w-full p-2 border rounded",disabled:o})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium",children:"Monte Carlo Runs"}),(0,s.jsxs)("select",{value:t.monteCarloRuns,onChange:e=>u({monteCarloRuns:Number(e.target.value)}),className:"w-full p-2 border rounded",disabled:o,children:[(0,s.jsx)("option",{value:100,children:"100"}),(0,s.jsx)("option",{value:500,children:"500"}),(0,s.jsx)("option",{value:1e3,children:"1000"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("button",{onClick:i,disabled:o,className:"w-full bg-blue-500 text-white p-2 rounded disabled:opacity-50",children:"Run Visual Simulation"}),(0,s.jsx)("button",{onClick:n,disabled:o,className:"w-full bg-green-500 text-white p-2 rounded disabled:opacity-50",children:"Run Monte Carlo"}),(0,s.jsx)("button",{onClick:r,className:"w-full bg-purple-500 text-white p-2 rounded",children:"Export Excel"}),(0,s.jsx)("button",{onClick:l,className:"w-full bg-gray-500 text-white p-2 rounded",children:"Reset"})]}),o&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,s.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(d,"%")}})}),(0,s.jsxs)("p",{className:"text-sm text-center mt-1",children:[Math.round(d),"%"]})]})]})}function r(e){let{nodes:t}=e,a=e=>{switch(e){case"red":return"bg-red-500 animate-pulse";case"orange":return"bg-orange-500";case"green":return"bg-green-500";default:return"bg-gray-500"}},i={arrival:{x:50,y:50},triage_queue:{x:150,y:50},triage_service:{x:250,y:50},ed_queue:{x:350,y:50},ed_service:{x:450,y:50},imaging_queue:{x:350,y:150},imaging_service:{x:450,y:150},result_review_queue:{x:550,y:150},result_review_service:{x:650,y:150},obs:{x:550,y:250},or_queue:{x:250,y:250},in_or:{x:350,y:250},icu_wait:{x:450,y:350},icu:{x:550,y:350},ward:{x:650,y:250},discharge:{x:750,y:200},transfer_out:{x:750,y:300},elevator_queue:{x:150,y:350}};return(0,s.jsx)("div",{className:"relative w-full h-full bg-gray-50",children:(0,s.jsxs)("svg",{viewBox:"0 0 800 400",className:"w-full h-full",children:[(0,s.jsx)("defs",{children:(0,s.jsx)("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",children:(0,s.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#666"})})}),(0,s.jsx)("line",{x1:"50",y1:"50",x2:"150",y2:"50",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"150",y1:"50",x2:"250",y2:"50",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"250",y1:"50",x2:"350",y2:"50",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"350",y1:"50",x2:"450",y2:"50",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"450",y1:"50",x2:"350",y2:"150",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"350",y1:"150",x2:"450",y2:"150",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"450",y1:"150",x2:"550",y2:"150",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"550",y1:"150",x2:"650",y2:"150",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"650",y1:"150",x2:"650",y2:"250",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"450",y1:"50",x2:"250",y2:"250",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"250",y1:"250",x2:"350",y2:"250",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"350",y1:"250",x2:"450",y2:"350",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"450",y1:"350",x2:"550",y2:"350",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"550",y1:"350",x2:"650",y2:"250",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"650",y1:"250",x2:"750",y2:"200",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"650",y1:"250",x2:"750",y2:"300",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),(0,s.jsx)("line",{x1:"250",y1:"250",x2:"150",y2:"350",stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),t.map(e=>{let t=i[e.node];return t?(0,s.jsxs)("g",{children:[(0,s.jsx)("circle",{cx:t.x,cy:t.y,r:"20",className:a(e.color),fill:"currentColor"}),(0,s.jsx)("text",{x:t.x,y:t.y+30,textAnchor:"middle",fontSize:"10",fill:"#333",children:e.node.replace("_"," ").toUpperCase()}),(0,s.jsxs)("text",{x:t.x,y:t.y-30,textAnchor:"middle",fontSize:"8",fill:"#333",children:["Q:",e.queueLength," U:",e.utilization.toFixed(2)]}),(0,s.jsxs)("text",{x:t.x,y:t.y-40,textAnchor:"middle",fontSize:"8",fill:"#333",children:["P95:",e.p95Wait.toFixed(1)," D:",e.deaths]})]},e.node):null})]})})}var l=a(5231),o=a(5974),d=a(4142),u=a(2842),c=a(9542),h=a(5475),x=a(8997),m=a(2566),g=a(153),j=a(6638);function p(e){let{snapshots:t,totalDeaths:a,totalPatients:i}=e,n=t.map(e=>{var t,a,s;return{time:(e.time/60).toFixed(1),icuUtilization:(null===(t=e.nodes.find(e=>"icu"===e.node))||void 0===t?void 0:t.utilization)||0,orUtilization:(null===(a=e.nodes.find(e=>"or"===e.node))||void 0===a?void 0:a.utilization)||0,ctQueue:(null===(s=e.nodes.find(e=>"imaging_queue"===e.node))||void 0===s?void 0:s.queueLength)||0}});return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Total Patients"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:i})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Total Deaths"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-red-600",children:a})]})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Mortality by Location"}),(0,s.jsx)(l.h,{width:"100%",height:200,children:(0,s.jsxs)(o.v,{data:[{location:"Triage",deaths:10},{location:"ED",deaths:20},{location:"Imaging",deaths:5},{location:"OR",deaths:15},{location:"ICU",deaths:25},{location:"Ward",deaths:30}],children:[(0,s.jsx)(d.q,{strokeDasharray:"3 3"}),(0,s.jsx)(u.K,{dataKey:"location"}),(0,s.jsx)(c.B,{}),(0,s.jsx)(h.u,{}),(0,s.jsx)(x.$,{dataKey:"deaths",fill:"#ef4444"})]})})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Top 5 Bottlenecks (RED Duration)"}),(0,s.jsx)("ul",{className:"space-y-2",children:[{node:"ICU",duration:120},{node:"OR",duration:100},{node:"ED",duration:80},{node:"Imaging",duration:60},{node:"Triage",duration:40}].map((e,t)=>(0,s.jsxs)("li",{className:"flex justify-between",children:[(0,s.jsxs)("span",{children:[t+1,". ",e.node]}),(0,s.jsxs)("span",{children:[e.duration,"h"]})]},e.node))})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Utilization Time Series"}),(0,s.jsx)(l.h,{width:"100%",height:200,children:(0,s.jsxs)(m.w,{data:n,children:[(0,s.jsx)(d.q,{strokeDasharray:"3 3"}),(0,s.jsx)(u.K,{dataKey:"time"}),(0,s.jsx)(c.B,{}),(0,s.jsx)(h.u,{}),(0,s.jsx)(g.D,{}),(0,s.jsx)(j.x,{type:"monotone",dataKey:"icuUtilization",stroke:"#8884d8",name:"ICU"}),(0,s.jsx)(j.x,{type:"monotone",dataKey:"orUtilization",stroke:"#82ca9d",name:"OR"})]})})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"CT Queue Length"}),(0,s.jsx)(l.h,{width:"100%",height:200,children:(0,s.jsxs)(m.w,{data:n,children:[(0,s.jsx)(d.q,{strokeDasharray:"3 3"}),(0,s.jsx)(u.K,{dataKey:"time"}),(0,s.jsx)(c.B,{}),(0,s.jsx)(h.u,{}),(0,s.jsx)(j.x,{type:"monotone",dataKey:"ctQueue",stroke:"#ff7300"})]})})]})]})}function v(){let[e,t]=(0,i.useState)({scenario:"daytime",baselineEDDaily:100,k1:10,k2:4,k3:1.5,policies:{p1:{active:!1,time:12},p2:{active:!1,time:12},p3:{active:!1,time:12},p4:{active:!1,time:12}},snapshotInterval:5,monteCarloRuns:500}),[l,o]=(0,i.useState)([]),[d,u]=(0,i.useState)(0),[c,h]=(0,i.useState)(!1),[x,m]=(0,i.useState)(0),[g,j]=(0,i.useState)(0),[v,y]=(0,i.useState)(0),b=[{node:"arrival",queueLength:0,utilization:0,p95Wait:0,deaths:0,color:"green"},{node:"triage_queue",queueLength:5,utilization:.8,p95Wait:15,deaths:0,color:"orange"},{node:"triage_service",queueLength:0,utilization:.6,p95Wait:10,deaths:0,color:"green"},{node:"ed_queue",queueLength:20,utilization:.95,p95Wait:45,deaths:2,color:"red"},{node:"ed_service",queueLength:0,utilization:.9,p95Wait:30,deaths:0,color:"orange"},{node:"imaging_queue",queueLength:15,utilization:1,p95Wait:60,deaths:1,color:"red"},{node:"imaging_service",queueLength:0,utilization:.8,p95Wait:20,deaths:0,color:"orange"},{node:"result_review_queue",queueLength:8,utilization:.7,p95Wait:25,deaths:0,color:"green"},{node:"result_review_service",queueLength:0,utilization:.5,p95Wait:15,deaths:0,color:"green"},{node:"obs",queueLength:3,utilization:.3,p95Wait:5,deaths:0,color:"green"},{node:"or_queue",queueLength:12,utilization:.9,p95Wait:50,deaths:3,color:"red"},{node:"in_or",queueLength:0,utilization:.85,p95Wait:40,deaths:1,color:"orange"},{node:"icu_wait",queueLength:10,utilization:.95,p95Wait:55,deaths:2,color:"red"},{node:"icu",queueLength:0,utilization:.92,p95Wait:35,deaths:5,color:"red"},{node:"ward",queueLength:25,utilization:.8,p95Wait:20,deaths:4,color:"orange"},{node:"discharge",queueLength:0,utilization:0,p95Wait:0,deaths:0,color:"green"},{node:"transfer_out",queueLength:0,utilization:0,p95Wait:0,deaths:0,color:"green"},{node:"elevator_queue",queueLength:6,utilization:.9,p95Wait:30,deaths:1,color:"orange"}],k=[{time:0,nodes:b.map(e=>({...e,queueLength:0,utilization:0})),totalPatients:0,totalDeaths:0,activeStaff:{}},{time:60,nodes:b,totalPatients:50,totalDeaths:5,activeStaff:{"ED doctor":5,"ED nurse":8}}];(0,i.useEffect)(()=>{o(k),j(5),y(50)},[]);let f=l[d]||{nodes:[],totalPatients:0,totalDeaths:0};return(0,s.jsx)("main",{className:"min-h-screen bg-gray-100",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-center mb-8",children:"Earthquake Hospital Simulator"}),(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-4 min-h-[80vh]",children:[(0,s.jsx)("div",{className:"col-span-3 bg-white p-4 rounded shadow overflow-y-auto max-h-[80vh]",children:(0,s.jsx)(n,{config:e,onConfigChange:t,onRunVisual:()=>{h(!0),m(0);let e=0,t=setInterval(()=>{m(e/10*100),u(e%k.length),++e>10&&(clearInterval(t),h(!1))},500)},onRunMonteCarlo:()=>{h(!0),m(0);let t=0,a=setInterval(()=>{m(t/e.monteCarloRuns*100),(t+=10)>e.monteCarloRuns&&(clearInterval(a),h(!1))},100)},onExportExcel:()=>{Promise.all([a.e(425),a.e(668)]).then(a.bind(a,5354)).then(t=>{let{exportToExcel:a}=t;a([{scenario:e.scenario,totalPatients:v,totalDeaths:g}],l,[{patientId:"p1",time:100,location:"icu",reason:"Overload"}],[],[{node:"icu",start:50,end:100,duration:50}])})},onReset:()=>{o([]),u(0),m(0),j(0),y(0)},isRunning:c,progress:x})}),(0,s.jsx)("div",{className:"col-span-6 bg-white p-4 rounded shadow",children:(0,s.jsx)(r,{nodes:f.nodes})}),(0,s.jsx)("div",{className:"col-span-3 bg-white p-4 rounded shadow overflow-y-auto max-h-[80vh]",children:(0,s.jsx)(p,{snapshots:l,totalDeaths:g,totalPatients:v})})]})]})})}}},function(e){e.O(0,[662,971,23,744],function(){return e(e.s=7145)}),_N_E=e.O()}]);